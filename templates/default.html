<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{title}} - {{siteName}}</title>
    <link rel="canonical" href="{{canonicalUrl}}">
    <link rel="stylesheet" href="{{rootPath}}css/{{styleSheet}}">
    
{{{seoMetaTags}}}
    
{{{seoStructuredData}}}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const NAV_STATE_KEY = 'foursg-nav-state';
            
            function saveNavState() {
                const state = {};
                document.querySelectorAll('.nav-folder').forEach(details => {
                    state[details.id] = details.open;
                });
                localStorage.setItem(NAV_STATE_KEY, JSON.stringify(state));
            }
            
            try {
                const state = JSON.parse(localStorage.getItem(NAV_STATE_KEY) || '{}');
                document.querySelectorAll('.nav-folder').forEach(details => {
                    // Always keep folders open if they contain the active page
                    const containsActive = details.querySelector('a.active') !== null;
                    if (containsActive) {
                        details.open = true;
                    } else if (state[details.id] !== undefined) {
                        details.open = state[details.id];
                    }
                    details.addEventListener('toggle', saveNavState);
                });
            } catch (e) {}
            
            // Close mobile sidebar when clicking outside
            const navToggle = document.getElementById('nav-toggle');
            const mainWrapper = document.querySelector('.main-wrapper');
            
            mainWrapper.addEventListener('click', function() {
                if (navToggle.checked) {
                    navToggle.checked = false;
                }
            });
        });
    </script>
</head>
<body>
    <input type="checkbox" id="nav-toggle" class="nav-toggle">
    
    <header class="site-header">
        <label for="nav-toggle" class="nav-toggle-label">â˜°</label>
        <a href="{{rootPath}}" class="site-title">{{siteName}}</a>
    </header>
    
    <aside class="sidebar">
        <nav class="site-nav">
            {{{navigation}}}
        </nav>
    </aside>
    
    <div class="main-wrapper">
        <main class="content">
            <article>
                <h1>{{title}}</h1>
                <div class="article-meta">
                    <small><span class="article-date">{{dates}}</span></small>
                </div>
                <div class="article-content">
                    {{{content}}}
                </div>
            </article>
        </main>
        
        <footer>
            <small>Generated with <a href="https://github.com/rezrov/foursg">FourSG</a> for <a href="https://obsidian.md">Obsidian</a></small>
        </footer>
    </div>
</body>
</html>
